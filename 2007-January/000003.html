<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Supertux-commit] r4524 - in trunk/supertux/src: . badguy object	scripting
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/supertux-commit/2007-January/index.html" >
   <LINK REL="made" HREF="mailto:supertux-commit%40lists.berlios.de?Subject=Re%3A%20%5BSupertux-commit%5D%20r4524%20-%20in%20trunk/supertux/src%3A%20.%20badguy%20object%0A%09scripting&In-Reply-To=%3C200701021707.l02H7qv3014013%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000002.html">
   <LINK REL="Next"  HREF="000004.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Supertux-commit] r4524 - in trunk/supertux/src: . badguy object	scripting</H1>
    <B>wolfgangb at BerliOS</B> 
    <A HREF="mailto:supertux-commit%40lists.berlios.de?Subject=Re%3A%20%5BSupertux-commit%5D%20r4524%20-%20in%20trunk/supertux/src%3A%20.%20badguy%20object%0A%09scripting&In-Reply-To=%3C200701021707.l02H7qv3014013%40sheep.berlios.de%3E"
       TITLE="[Supertux-commit] r4524 - in trunk/supertux/src: . badguy object	scripting">wolfgangb at mail.berlios.de
       </A><BR>
    <I>Tue Jan  2 18:07:52 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000002.html">[Supertux-commit] r4523 - in trunk/supertux/src: . badguy object	scripting
</A></li>
        <LI>Next message: <A HREF="000004.html">[Supertux-commit] r4525 - in trunk/supertux: data/levels/world2	src/badguy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3">[ date ]</a>
              <a href="thread.html#3">[ thread ]</a>
              <a href="subject.html#3">[ subject ]</a>
              <a href="author.html#3">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: wolfgangb
Date: 2007-01-02 18:07:50 +0100 (Tue, 02 Jan 2007)
New Revision: 4524

Modified:
   trunk/supertux/src/badguy/angrystone.cpp
   trunk/supertux/src/badguy/badguy.cpp
   trunk/supertux/src/badguy/bomb.cpp
   trunk/supertux/src/badguy/bouncing_snowball.cpp
   trunk/supertux/src/badguy/dart.cpp
   trunk/supertux/src/badguy/fish.cpp
   trunk/supertux/src/badguy/flyingsnowball.cpp
   trunk/supertux/src/badguy/jumpy.cpp
   trunk/supertux/src/badguy/kugelblitz.cpp
   trunk/supertux/src/badguy/mole.cpp
   trunk/supertux/src/badguy/mole_rock.cpp
   trunk/supertux/src/badguy/mriceblock.cpp
   trunk/supertux/src/badguy/mrrocket.cpp
   trunk/supertux/src/badguy/plant.cpp
   trunk/supertux/src/badguy/skullyhop.cpp
   trunk/supertux/src/badguy/snail.cpp
   trunk/supertux/src/badguy/spidermite.cpp
   trunk/supertux/src/badguy/sspiky.cpp
   trunk/supertux/src/badguy/stalactite.cpp
   trunk/supertux/src/badguy/stumpy.cpp
   trunk/supertux/src/badguy/toad.cpp
   trunk/supertux/src/badguy/totem.cpp
   trunk/supertux/src/badguy/walking_badguy.cpp
   trunk/supertux/src/badguy/yeti.cpp
   trunk/supertux/src/badguy/zeekling.cpp
   trunk/supertux/src/object/bullet.cpp
   trunk/supertux/src/object/camera.cpp
   trunk/supertux/src/object/falling_coin.cpp
   trunk/supertux/src/object/growup.cpp
   trunk/supertux/src/object/oneup.cpp
   trunk/supertux/src/object/player.cpp
   trunk/supertux/src/object/powerup.cpp
   trunk/supertux/src/object/pushbutton.cpp
   trunk/supertux/src/object/rock.cpp
   trunk/supertux/src/object/scripted_object.cpp
   trunk/supertux/src/object/skull_tile.cpp
   trunk/supertux/src/object/star.cpp
   trunk/supertux/src/object/trampoline.cpp
   trunk/supertux/src/object/unstable_tile.cpp
   trunk/supertux/src/physic.cpp
   trunk/supertux/src/physic.hpp
   trunk/supertux/src/scripting/functions.cpp
Log:
Sorry, was too early for that patch.

Modified: trunk/supertux/src/badguy/angrystone.cpp
===================================================================
--- trunk/supertux/src/badguy/angrystone.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/angrystone.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -47,9 +47,9 @@
 void
 AngryStone::activate()
 {
-  physic.vx = 0;
-  physic.vy = 0;
-  physic.gravity_enabled = true;
+  physic.set_velocity_x(0);
+  physic.set_velocity_y(0);
+  physic.enable_gravity(true);
   sprite-&gt;set_action(&quot;idle&quot;);
 }
 
@@ -63,9 +63,9 @@
       (hit.normal.x == -attackDirection.x) &amp;&amp; (hit.normal.y == attackDirection.y)) {
     state = IDLE;
     sprite-&gt;set_action(&quot;idle&quot;);
-    physic.vx = 0;
-    physic.vy = 0;
-    physic.gravity_enabled = true;
+    physic.set_velocity_x(0);
+    physic.set_velocity_y(0);
+    physic.enable_gravity(true);
     oldWallDirection.x = attackDirection.x;
     oldWallDirection.y = attackDirection.y;
   }
@@ -143,9 +143,9 @@
       sprite-&gt;set_action(&quot;attacking&quot;);
       timer.start(ATTACK_TIME);
       state = ATTACKING;
-      physic.gravity_enabled = false;
-      physic.vx = SPEED * attackDirection.x;
-      physic.vy = SPEED * attackDirection.y;
+      physic.enable_gravity(false);
+      physic.set_velocity_x(SPEED * attackDirection.x);
+      physic.set_velocity_y(SPEED * attackDirection.y);
       oldWallDirection.x = 0;
       oldWallDirection.y = 0;
     }
@@ -156,9 +156,9 @@
       timer.start(RECOVER_TIME);
       state = RECOVERING;
       sprite-&gt;set_action(&quot;idle&quot;);
-      physic.gravity_enabled = true;
-      physic.vx = 0;
-      physic.vy = 0;
+      physic.enable_gravity(true);
+      physic.set_velocity_x(0);
+      physic.set_velocity_y(0);
     }
   }
 
@@ -166,9 +166,9 @@
     if (timer.check()) {
       state = IDLE;
       sprite-&gt;set_action(&quot;idle&quot;);
-      physic.gravity_enabled = true;
-      physic.vx = 0;
-      physic.vy = 0;
+      physic.enable_gravity(true);
+      physic.set_velocity_x(0);
+      physic.set_velocity_y(0);
     }
   }
 

Modified: trunk/supertux/src/badguy/badguy.cpp
===================================================================
--- trunk/supertux/src/badguy/badguy.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/badguy.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -228,8 +228,8 @@
 void
 BadGuy::collision_solid(const CollisionHit&amp; hit)
 {
-  physic.vx = 0;
-  physic.vy = 0;
+  physic.set_velocity_x(0);
+  physic.set_velocity_y(0);
   update_on_ground_flag(hit);
 }
 
@@ -309,9 +309,9 @@
 BadGuy::kill_squished(GameObject&amp; object)
 {
   sound_manager-&gt;play(&quot;sounds/squish.wav&quot;, get_pos());
-  physic.gravity_enabled = true;
-  physic.vx = 0;
-  physic.vy = 0;
+  physic.enable_gravity(true);
+  physic.set_velocity_x(0);
+  physic.set_velocity_y(0);
   set_state(STATE_SQUISHED);
   set_group(COLGROUP_MOVING_ONLY_STATIC);
   Player* player = dynamic_cast&lt;Player*&gt;(&amp;object);
@@ -326,8 +326,8 @@
 {
   sound_manager-&gt;play(&quot;sounds/fall.wav&quot;, get_pos());
   if (countMe) Sector::current()-&gt;get_level()-&gt;stats.badguys++;
-  physic.vy = 0;
-  physic.gravity_enabled = true;
+  physic.set_velocity_y(0);
+  physic.enable_gravity(true);
   set_state(STATE_FALLING);
 }
 

Modified: trunk/supertux/src/badguy/bomb.cpp
===================================================================
--- trunk/supertux/src/badguy/bomb.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/bomb.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -61,7 +61,7 @@
 Bomb::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.bottom)
-    physic.vy = 0;
+    physic.set_velocity_y(0);
 }
 
 HitResponse

Modified: trunk/supertux/src/badguy/bouncing_snowball.cpp
===================================================================
--- trunk/supertux/src/badguy/bouncing_snowball.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/bouncing_snowball.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -48,7 +48,7 @@
 void
 BouncingSnowball::activate()
 {
-  physic.vx = (dir == LEFT ? -WALKSPEED : WALKSPEED);
+  physic.set_velocity_x(dir == LEFT ? -WALKSPEED : WALKSPEED);
   sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
 }
 
@@ -65,18 +65,18 @@
 {
   if(hit.bottom) {
     if(get_state() == STATE_ACTIVE) {
-      physic.vy = JUMPSPEED;
+      physic.set_velocity_y(JUMPSPEED);
     } else {
-      physic.vy = 0;
+      physic.set_velocity_y(0);
     }
   } else if(hit.top) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 
   if(hit.left || hit.right) { // left or right collision
     dir = dir == LEFT ? RIGHT : LEFT;
     sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
-    physic.vx = -physic.vx;
+    physic.set_velocity_x(-physic.get_velocity_x());
   }
 }
 

Modified: trunk/supertux/src/badguy/dart.cpp
===================================================================
--- trunk/supertux/src/badguy/dart.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/dart.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -31,7 +31,7 @@
 Dart::Dart(const lisp::Lisp&amp; reader)
 	: BadGuy(reader, &quot;images/creatures/dart/dart.sprite&quot;), parent(0)
 {
-  physic.gravity_enabled = false;
+  physic.enable_gravity(false);
   countMe = false;
   sound_manager-&gt;preload(&quot;sounds/darthit.wav&quot;);
   sound_manager-&gt;preload(&quot;sounds/stomp.wav&quot;);
@@ -40,7 +40,7 @@
 Dart::Dart(const Vector&amp; pos, Direction d, const BadGuy* parent = 0)
 	: BadGuy(pos, d, &quot;images/creatures/dart/dart.sprite&quot;), parent(parent)
 {
-  physic.gravity_enabled = false;
+  physic.enable_gravity(false);
   countMe = false;
   sound_manager-&gt;preload(&quot;sounds/darthit.wav&quot;);
   sound_manager-&gt;preload(&quot;sounds/stomp.wav&quot;);
@@ -80,7 +80,7 @@
 void
 Dart::activate()
 {
-  physic.vx = (dir == LEFT ? -::SPEED : ::SPEED);
+  physic.set_velocity_x(dir == LEFT ? -::SPEED : ::SPEED);
   sprite-&gt;set_action(dir == LEFT ? &quot;flying-left&quot; : &quot;flying-right&quot;);
 
   sound_source.reset(sound_manager-&gt;create_sound_source(SOUNDFILE));

Modified: trunk/supertux/src/badguy/fish.cpp
===================================================================
--- trunk/supertux/src/badguy/fish.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/fish.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -30,13 +30,13 @@
 Fish::Fish(const lisp::Lisp&amp; reader)
 	: BadGuy(reader, &quot;images/creatures/fish/fish.sprite&quot;, LAYER_TILES-1), stop_y(0)
 {
-  physic.gravity_enabled = true;
+  physic.enable_gravity(true);
 }
 
 Fish::Fish(const Vector&amp; pos)
 	: BadGuy(pos, &quot;images/creatures/fish/fish.sprite&quot;, LAYER_TILES-1), stop_y(0)
 {
-  physic.gravity_enabled = true;
+  physic.enable_gravity(true);
 }
 
 void
@@ -75,7 +75,7 @@
 Fish::hit(const CollisionHit&amp; hit)
 {
   if(hit.top) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 
   return CONTINUE;
@@ -84,7 +84,7 @@
 void
 Fish::collision_tile(uint32_t tile_attributes)
 {
-  if ((tile_attributes &amp; Tile::WATER) &amp;&amp; (physic.vy &gt;= 0)) {
+  if ((tile_attributes &amp; Tile::WATER) &amp;&amp; (physic.get_velocity_y() &gt;= 0)) {
 
     // initialize stop position if uninitialized
     if (stop_y == 0) stop_y = get_pos().y + get_bbox().get_height();
@@ -111,13 +111,13 @@
 
   // set sprite
   if(!frozen)
-    sprite-&gt;set_action(physic.vy &lt; 0 ? &quot;normal&quot; : &quot;down&quot;);
+    sprite-&gt;set_action(physic.get_velocity_y() &lt; 0 ? &quot;normal&quot; : &quot;down&quot;);
 
   // we can't afford flying out of the tilemap, 'cause the engine would remove us.
   if ((get_pos().y - 31.8) &lt; 0) // too high, let us fall
   {
-    physic.vy = 0;
-    physic.gravity_enabled = true;
+    physic.set_velocity_y(0);
+    physic.enable_gravity(true);
   }
 }
 
@@ -126,15 +126,15 @@
 {
   waiting.start(FISH_WAIT_TIME);
   set_group(COLGROUP_DISABLED);
-  physic.gravity_enabled = false;
-  physic.vy = 0;
+  physic.enable_gravity(false);
+  physic.set_velocity_y(0);
 }
 
 void
 Fish::jump()
 {
-  physic.vy = FISH_JUMP_POWER;
-  physic.gravity_enabled = true;
+  physic.set_velocity_y(FISH_JUMP_POWER);
+  physic.enable_gravity(true);
   set_group(COLGROUP_MOVING);
 }
 
@@ -142,7 +142,7 @@
 Fish::freeze()
 {
   BadGuy::freeze();
-  sprite-&gt;set_action(physic.vy &lt; 0 ? &quot;iced&quot; : &quot;iced-down&quot;);
+  sprite-&gt;set_action(physic.get_velocity_y() &lt; 0 ? &quot;iced&quot; : &quot;iced-down&quot;);
   waiting.stop();
 }
 

Modified: trunk/supertux/src/badguy/flyingsnowball.cpp
===================================================================
--- trunk/supertux/src/badguy/flyingsnowball.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/flyingsnowball.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -37,13 +37,13 @@
 FlyingSnowBall::FlyingSnowBall(const lisp::Lisp&amp; reader)
 	: BadGuy(reader, &quot;images/creatures/flying_snowball/flying_snowball.sprite&quot;)
 {
-  physic.gravity_enabled = false;
+  physic.enable_gravity(false);
 }
 
 FlyingSnowBall::FlyingSnowBall(const Vector&amp; pos)
 	: BadGuy(pos, &quot;images/creatures/flying_snowball/flying_snowball.sprite&quot;)
 {
-  physic.gravity_enabled = false;
+  physic.enable_gravity(false);
 }
 
 void
@@ -62,7 +62,7 @@
 {
   sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
   mode = FLY_UP;
-  physic.vy = FLYSPEED;
+  physic.set_velocity_y(FLYSPEED);
   timer.start(FLYTIME/2);
   puff_timer.start(systemRandom.randf(PUFF_INTERVAL_MIN, PUFF_INTERVAL_MAX));
 }
@@ -79,7 +79,7 @@
 FlyingSnowBall::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.top || hit.bottom) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 }
 
@@ -89,14 +89,14 @@
   if(timer.check()) {
     if(mode == FLY_UP) {
       mode = FLY_DOWN;
-      physic.vy = -FLYSPEED;
+      physic.set_velocity_y(-FLYSPEED);
 
       // stop puffing
       puff_timer.stop();
 
     } else if(mode == FLY_DOWN) {
       mode = FLY_UP;
-      physic.vy = FLYSPEED;
+      physic.set_velocity_y(FLYSPEED);
 
       // roll a dice whether to start puffing
       if (systemRandom.randf(0, 1) &lt; PUFF_PROBABILITY) {

Modified: trunk/supertux/src/badguy/jumpy.cpp
===================================================================
--- trunk/supertux/src/badguy/jumpy.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/jumpy.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -63,11 +63,11 @@
       groundhit_pos_set = true;
     }
 
-    physic.vy = (frozen ? 0 : JUMPSPEED);
+    physic.set_velocity_y(frozen ? 0 : JUMPSPEED);
     // TODO create a nice sound for this...
     //sound_manager-&gt;play(&quot;sounds/skid.wav&quot;);
   } else if(chit.top) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 
   return CONTINUE;
@@ -106,7 +106,7 @@
 Jumpy::freeze()
 {
   BadGuy::freeze();
-  physic.vy = std::max(0.0f, physic.vy);
+  physic.set_velocity_y(std::max(0.0f, physic.get_velocity_y()));
   sprite-&gt;set_action(dir == LEFT ? &quot;left-iced&quot; : &quot;right-iced&quot;);
 }
 

Modified: trunk/supertux/src/badguy/kugelblitz.cpp
===================================================================
--- trunk/supertux/src/badguy/kugelblitz.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/kugelblitz.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -38,7 +38,7 @@
 {
   reader.get(&quot;x&quot;, start_position.x);
   sprite-&gt;set_action(&quot;falling&quot;);
-  physic.gravity_enabled = false;
+  physic.enable_gravity(false);
 }
 
 void
@@ -54,8 +54,8 @@
 void
 Kugelblitz::activate()
 {
-  physic.vy = 300;
-  physic.vx = -20; //fall a little to the left
+  physic.set_velocity_y(300);
+  physic.set_velocity_x(-20); //fall a little to the left
   direction = 1;
   dying = false;
 }
@@ -107,16 +107,16 @@
       groundhit_pos_set = true;
     }
     sprite-&gt;set_action(&quot;flying&quot;);
-    physic.vy = 0;
+    physic.set_velocity_y(0);
     //Set random initial speed and direction
     direction = systemRandom.rand(2)? 1: -1;
     int speed = (BASE_SPEED + (systemRandom.rand(RAND_SPEED))) * direction;
-    physic.vx = speed;
+    physic.set_velocity_x(speed);
     movement_timer.start(MOVETIME);
     lifetime.start(LIFETIME);
 
   } else if(hit.top) { // bumped on roof
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 
   return CONTINUE;
@@ -133,7 +133,7 @@
       if (movement_timer.check()) {
         if (direction == 1) direction = -1; else direction = 1;
         int speed = (BASE_SPEED + (systemRandom.rand(RAND_SPEED))) * direction;
-        physic.vx = speed;
+        physic.set_velocity_x(speed);
         movement_timer.start(MOVETIME);
       }
     }

Modified: trunk/supertux/src/badguy/mole.cpp
===================================================================
--- trunk/supertux/src/badguy/mole.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/mole.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -35,13 +35,13 @@
 Mole::Mole(const lisp::Lisp&amp; reader)
 	: BadGuy(reader, &quot;images/creatures/mole/mole.sprite&quot;, LAYER_TILES-1), state(PRE_THROWING)
 {
-  physic.gravity_enabled = false;
+  physic.enable_gravity(false);
 }
 
 Mole::Mole(const Vector&amp; pos)
 	: BadGuy(pos, &quot;images/creatures/mole/mole.sprite&quot;, LAYER_TILES-1), state(PRE_THROWING)
 {
-  physic.gravity_enabled = false;
+  physic.enable_gravity(false);
 }
 
 void

Modified: trunk/supertux/src/badguy/mole_rock.cpp
===================================================================
--- trunk/supertux/src/badguy/mole_rock.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/mole_rock.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -25,14 +25,14 @@
 MoleRock::MoleRock(const lisp::Lisp&amp; reader)
 	: BadGuy(reader, &quot;images/creatures/mole/mole_rock.sprite&quot;, LAYER_TILES - 2), parent(0), initial_velocity(Vector(0, -400))
 {
-  physic.gravity_enabled = true;
+  physic.enable_gravity(true);
   countMe = false;
 }
 
 MoleRock::MoleRock(const Vector&amp; pos, const Vector&amp; velocity, const BadGuy* parent = 0)
 	: BadGuy(pos, LEFT, &quot;images/creatures/mole/mole_rock.sprite&quot;, LAYER_TILES - 2), parent(parent), initial_velocity(velocity)
 {
-  physic.gravity_enabled = true;
+  physic.enable_gravity(true);
   countMe = false;
 }
 
@@ -67,8 +67,7 @@
 void
 MoleRock::activate()
 {
-  physic.vx = initial_velocity.x;
-  physic.vy = initial_velocity.y;
+  physic.set_velocity(initial_velocity);
   sprite-&gt;set_action(&quot;default&quot;);
 }
 

Modified: trunk/supertux/src/badguy/mriceblock.cpp
===================================================================
--- trunk/supertux/src/badguy/mriceblock.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/mriceblock.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -92,7 +92,7 @@
   update_on_ground_flag(hit);
 
   if(hit.top || hit.bottom) { // floor or roof
-    physic.vy = 0;
+    physic.set_velocity_y(0);
     return;
   }
 
@@ -105,17 +105,17 @@
       if(hit.right &amp;&amp; dir == RIGHT) {
         dir = LEFT;
         sound_manager-&gt;play(&quot;sounds/iceblock_bump.wav&quot;, get_pos());
-        physic.vx = -KICKSPEED;
+        physic.set_velocity_x(-KICKSPEED);
       } else if(hit.left &amp;&amp; dir == LEFT) {
         dir = RIGHT;
         sound_manager-&gt;play(&quot;sounds/iceblock_bump.wav&quot;, get_pos());
-        physic.vx = KICKSPEED;
+        physic.set_velocity_x(KICKSPEED);
       }
       sprite-&gt;set_action(dir == LEFT ? &quot;flat-left&quot; : &quot;flat-right&quot;);
       break;
     }
     case ICESTATE_FLAT:
-      physic.vx = 0;
+      physic.set_velocity_x(0);
       break;
     case ICESTATE_GRABBED:
       break;
@@ -220,8 +220,8 @@
       break;
     case ICESTATE_FLAT:
       sound_manager-&gt;play(&quot;sounds/stomp.wav&quot;, get_pos());
-      physic.vx = 0;
-      physic.vy = 0;
+      physic.set_velocity_x(0);
+      physic.set_velocity_y(0);
 
       sprite-&gt;set_action(dir == LEFT ? &quot;flat-left&quot; : &quot;flat-right&quot;);
       flat_timer.start(4);
@@ -229,7 +229,7 @@
     case ICESTATE_KICKED:
       sound_manager-&gt;play(&quot;sounds/kick.wav&quot;, get_pos());
 
-      physic.vx = (dir == LEFT ? -KICKSPEED : KICKSPEED);
+      physic.set_velocity_x(dir == LEFT ? -KICKSPEED : KICKSPEED);
       sprite-&gt;set_action(dir == LEFT ? &quot;flat-left&quot; : &quot;flat-right&quot;);
       // we should slide above 1 block holes now...
       bbox.set_size(34, 31.8);

Modified: trunk/supertux/src/badguy/mrrocket.cpp
===================================================================
--- trunk/supertux/src/badguy/mrrocket.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/mrrocket.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -47,8 +47,8 @@
 void
 MrRocket::activate()
 {
-  physic.vx = (dir == LEFT ? -SPEED : SPEED);
-  physic.gravity_enabled = false;
+  physic.set_velocity_x(dir == LEFT ? -SPEED : SPEED);
+  physic.enable_gravity(false);
   sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
 }
 
@@ -78,10 +78,10 @@
 MrRocket::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.top || hit.bottom) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   } else if(hit.left || hit.right) {
     sprite-&gt;set_action(dir == LEFT ? &quot;collision-left&quot; : &quot;collision-right&quot;);
-    physic.vx = 0;
+    physic.set_velocity_x(0);
     collision_timer.start(0.2, true);
   }
 }

Modified: trunk/supertux/src/badguy/plant.cpp
===================================================================
--- trunk/supertux/src/badguy/plant.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/plant.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -48,7 +48,7 @@
   dir = dir == LEFT ? RIGHT : LEFT;
 
   state = PLANT_SLEEPING;
-  physic.vx = 0;
+  physic.set_velocity_x(0);
   sprite-&gt;set_action(dir == LEFT ? &quot;sleeping-left&quot; : &quot;sleeping-right&quot;);
 }
 
@@ -56,11 +56,11 @@
 Plant::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.top || hit.bottom) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   } else if(hit.left || hit.right) {
     dir = dir == LEFT ? RIGHT : LEFT;
     sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
-    physic.vx = -physic.vx;
+    physic.set_velocity_x(-physic.get_velocity_x());
   }
 }
 
@@ -72,7 +72,7 @@
   if(hit.left || hit.right) {
     dir = dir == LEFT ? RIGHT : LEFT;
     sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
-    physic.vx = -physic.vx;
+    physic.set_velocity_x(-physic.get_velocity_x());
   }
 
   return CONTINUE;
@@ -107,7 +107,7 @@
     if(timer.check()) {
       // start walking
       sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
-      physic.vx = (dir == LEFT ? -WALKSPEED : WALKSPEED);
+      physic.set_velocity_x(dir == LEFT ? -WALKSPEED : WALKSPEED);
       state = PLANT_WALKING;
     }
   }

Modified: trunk/supertux/src/badguy/skullyhop.cpp
===================================================================
--- trunk/supertux/src/badguy/skullyhop.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/skullyhop.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -63,8 +63,8 @@
 SkullyHop::set_state(SkullyHopState newState)
 {
   if (newState == STANDING) {
-    physic.vx = 0;
-    physic.vy = 0;
+    physic.set_velocity_x(0);
+    physic.set_velocity_y(0);
     sprite-&gt;set_action(dir == LEFT ? &quot;standing-left&quot; : &quot;standing-right&quot;);
 
     float recover_time = systemRandom.randf(MIN_RECOVER_TIME,MAX_RECOVER_TIME);
@@ -75,8 +75,8 @@
   } else
   if (newState == JUMPING) {
     sprite-&gt;set_action(dir == LEFT ? &quot;jumping-left&quot; : &quot;jumping-right&quot;);
-    physic.vx = (dir == LEFT ? -HORIZONTAL_SPEED : HORIZONTAL_SPEED);
-    physic.vy = VERTICAL_SPEED;
+    physic.set_velocity_x(dir == LEFT ? -HORIZONTAL_SPEED : HORIZONTAL_SPEED);
+    physic.set_velocity_y(VERTICAL_SPEED);
     sound_manager-&gt;play( HOP_SOUND, get_pos());
   }
 
@@ -104,19 +104,19 @@
     return;
 
   // check if we hit the floor while falling
-  if(hit.bottom &amp;&amp; physic.vy &gt; 0 ) {
+  if(hit.bottom &amp;&amp; physic.get_velocity_y() &gt; 0 ) {
     set_state(STANDING);
   }
   // check if we hit the roof while climbing
   if(hit.top) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 
   // check if we hit left or right while moving in either direction
   if(hit.left || hit.right) {
     dir = dir == LEFT ? RIGHT : LEFT;
     sprite-&gt;set_action(dir == LEFT ? &quot;jumping-left&quot; : &quot;jumping-right&quot;);
-    physic.vx = -0.25*physic.vx;
+    physic.set_velocity_x(-0.25*physic.get_velocity_x());
   }
 }
 

Modified: trunk/supertux/src/badguy/snail.cpp
===================================================================
--- trunk/supertux/src/badguy/snail.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/snail.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -79,8 +79,8 @@
   sprite-&gt;set_action(dir == LEFT ? &quot;flat-left&quot; : &quot;flat-right&quot;);
   sprite-&gt;set_fps(64);
 
-  physic.vx = 0;
-  physic.vy = 0;
+  physic.set_velocity_x(0);
+  physic.set_velocity_y(0);
 
   flat_timer.start(4);
 }
@@ -92,8 +92,8 @@
   sprite-&gt;set_action(dir == LEFT ? &quot;flat-left&quot; : &quot;flat-right&quot;);
   sprite-&gt;set_fps(64);
 
-  physic.vx = 0;
-  physic.vy = 0;
+  physic.set_velocity_x(0);
+  physic.set_velocity_y(0);
 
   // start a timer to delay addition of upward movement until we are (hopefully) out from under the player
   kicked_delay_timer.start(0.05);
@@ -125,16 +125,16 @@
 
     case STATE_KICKED_DELAY:
       if (kicked_delay_timer.check()) {
-	physic.vx = (dir == LEFT ? -KICKSPEED : KICKSPEED);
-	physic.vy = KICKSPEED_Y;
+	physic.set_velocity_x(dir == LEFT ? -KICKSPEED : KICKSPEED);
+	physic.set_velocity_y(KICKSPEED_Y);
 	state = STATE_KICKED;
       }
       BadGuy::active_update(elapsed_time);
       break;
 
     case STATE_KICKED:
-      physic.vx = physic.vx * pow(0.99, elapsed_time/0.02);
-      if (fabsf(physic.vx) &lt; walk_speed) be_normal();
+      physic.set_velocity_x(physic.get_velocity_x() * pow(0.99, elapsed_time/0.02));
+      if (fabsf(physic.get_velocity_x()) &lt; walk_speed) be_normal();
       BadGuy::active_update(elapsed_time);
       break;
 
@@ -152,22 +152,22 @@
       break;
     case STATE_FLAT:
       if(hit.top || hit.bottom) {
-	physic.vy = 0;
+	physic.set_velocity_y(0);
       }
       if(hit.left || hit.right) {
       }
       break;
     case STATE_KICKED_DELAY:
       if(hit.top || hit.bottom) {
-	physic.vy = 0;
+	physic.set_velocity_y(0);
       }
       if(hit.left || hit.right) {
-	physic.vy = 0;
+	physic.set_velocity_x(0);
       }
       break;
     case STATE_KICKED:
       if(hit.top || hit.bottom) {
-	physic.vy = 0;
+	physic.set_velocity_y(0);
       }
       if(hit.left || hit.right) {
 	sound_manager-&gt;play(&quot;sounds/iceblock_bump.wav&quot;, get_pos());
@@ -176,8 +176,8 @@
 	  dir = (dir == LEFT) ? RIGHT : LEFT;
 	  sprite-&gt;set_action(dir == LEFT ? &quot;flat-left&quot; : &quot;flat-right&quot;);
 
-	  physic.vx = -physic.vx*0.75;
-	  if (fabsf(physic.vx) &lt; walk_speed) be_normal();
+	  physic.set_velocity_x(-physic.get_velocity_x()*0.75);
+	  if (fabsf(physic.get_velocity_x()) &lt; walk_speed) be_normal();
 	}
 
       }

Modified: trunk/supertux/src/badguy/spidermite.cpp
===================================================================
--- trunk/supertux/src/badguy/spidermite.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/spidermite.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -28,13 +28,13 @@
 SpiderMite::SpiderMite(const lisp::Lisp&amp; reader)
 	: BadGuy(reader, &quot;images/creatures/spidermite/spidermite.sprite&quot;)
 {
-  physic.gravity_enabled = false;
+  physic.enable_gravity(false);
 }
 
 SpiderMite::SpiderMite(const Vector&amp; pos)
 	: BadGuy(pos, &quot;images/creatures/spidermite/spidermite.sprite&quot;)
 {
-  physic.gravity_enabled = false;
+  physic.enable_gravity(false);
 }
 
 void
@@ -53,7 +53,7 @@
 {
   sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
   mode = FLY_UP;
-  physic.vy = FLYSPEED;
+  physic.set_velocity_y(FLYSPEED);
   timer.start(FLYTIME/2);
 }
 
@@ -69,7 +69,7 @@
 SpiderMite::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.top || hit.bottom) { // hit floor or roof?
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 }
 
@@ -79,10 +79,10 @@
   if(timer.check()) {
     if(mode == FLY_UP) {
       mode = FLY_DOWN;
-      physic.vy = -FLYSPEED;
+      physic.set_velocity_y(-FLYSPEED);
     } else if(mode == FLY_DOWN) {
       mode = FLY_UP;
-      physic.vy = FLYSPEED;
+      physic.set_velocity_y(FLYSPEED);
     }
     timer.start(FLYTIME);
   }

Modified: trunk/supertux/src/badguy/sspiky.cpp
===================================================================
--- trunk/supertux/src/badguy/sspiky.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/sspiky.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -42,7 +42,7 @@
 SSpiky::activate()
 {
   state = SSPIKY_SLEEPING;
-  physic.vx = 0;
+  physic.set_velocity_x(0);
   sprite-&gt;set_action(dir == LEFT ? &quot;sleeping-left&quot; : &quot;sleeping-right&quot;);
 }
 

Modified: trunk/supertux/src/badguy/stalactite.cpp
===================================================================
--- trunk/supertux/src/badguy/stalactite.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/stalactite.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -59,7 +59,7 @@
   } else if(state == STALACTITE_SHAKING) {
     if(timer.check()) {
       state = STALACTITE_FALLING;
-      physic.gravity_enabled = true;
+      physic.enable_gravity(true);
     }
   } else if(state == STALACTITE_FALLING || state == STALACTITE_SQUISHED) {
     movement = physic.get_movement(elapsed_time);
@@ -85,7 +85,7 @@
     if (hit.bottom) squish();
   }
   if(state == STALACTITE_SQUISHED) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 }
 

Modified: trunk/supertux/src/badguy/stumpy.cpp
===================================================================
--- trunk/supertux/src/badguy/stumpy.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/stumpy.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -61,7 +61,7 @@
     case STATE_INVINCIBLE:
       sprite-&gt;set_action(dir == LEFT ? &quot;dizzy-left&quot; : &quot;dizzy-right&quot;);
       bbox.set_size(sprite-&gt;get_current_hitbox_width(), sprite-&gt;get_current_hitbox_height());
-      physic.vx = 0;
+      physic.set_velocity_x(0);
       break;
     case STATE_NORMAL:
       WalkingBadguy::activate();
@@ -132,10 +132,10 @@
   switch (mystate) {
     case STATE_INVINCIBLE:
       if(hit.top || hit.bottom) {
-        physic.vy = 0;
+        physic.set_velocity_y(0);
       }
       if(hit.left || hit.right) {
-        physic.vx = 0;
+        physic.set_velocity_x(0);
       }
       break;
     case STATE_NORMAL:
@@ -150,10 +150,10 @@
   switch (mystate) {
     case STATE_INVINCIBLE:
       if(hit.top || hit.bottom) {
-	physic.vy = 0;
+	physic.set_velocity_y(0);
       }
       if(hit.left || hit.right) {
-	physic.vx = 0;
+	physic.set_velocity_x(0);
       }
       return CONTINUE;
       break;

Modified: trunk/supertux/src/badguy/toad.cpp
===================================================================
--- trunk/supertux/src/badguy/toad.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/toad.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -62,16 +62,16 @@
 Toad::set_state(ToadState newState)
 {
   if (newState == IDLE) {
-    physic.vx = 0;
-    physic.vy = 0;
+    physic.set_velocity_x(0);
+    physic.set_velocity_y(0);
     sprite-&gt;set_action(dir == LEFT ? &quot;idle-left&quot; : &quot;idle-right&quot;);
 
     recover_timer.start(RECOVER_TIME);
   } else
   if (newState == JUMPING) {
     sprite-&gt;set_action(dir == LEFT ? &quot;jumping-left&quot; : &quot;jumping-right&quot;);
-    physic.vx = (dir == LEFT ? -HORIZONTAL_SPEED : HORIZONTAL_SPEED);
-    physic.vy = VERTICAL_SPEED;
+    physic.set_velocity_x(dir == LEFT ? -HORIZONTAL_SPEED : HORIZONTAL_SPEED);
+    physic.set_velocity_y(VERTICAL_SPEED);
     sound_manager-&gt;play( HOP_SOUND, get_pos());
   } else
   if (newState == FALLING) {
@@ -108,7 +108,7 @@
   }
 
   // check if we hit left or right while moving in either direction
-  if(((physic.vx &lt; 0) &amp;&amp; hit.left) || ((physic.vx &gt; 0) &amp;&amp; hit.right)) {
+  if(((physic.get_velocity_x() &lt; 0) &amp;&amp; hit.left) || ((physic.get_velocity_x() &gt; 0) &amp;&amp; hit.right)) {
     /*
     dir = dir == LEFT ? RIGHT : LEFT;
     if (state == JUMPING) {
@@ -117,7 +117,7 @@
       sprite-&gt;set_action(dir == LEFT ? &quot;idle-left&quot; : &quot;idle-right&quot;);
     }
     */
-    physic.vx = -0.25*physic.vx;
+    physic.set_velocity_x(-0.25*physic.get_velocity_x());
   }
 
   // check if we hit the floor while falling
@@ -128,7 +128,7 @@
 
   // check if we hit the roof while climbing
   if ((state == JUMPING) &amp;&amp; hit.top) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 
 }
@@ -148,7 +148,7 @@
   BadGuy::active_update(elapsed_time);
 
   // change sprite when we are falling
-  if ((state == JUMPING) &amp;&amp; (physic.vy &gt; 0)) {
+  if ((state == JUMPING) &amp;&amp; (physic.get_velocity_y() &gt; 0)) {
     set_state(FALLING);
     return;
   }

Modified: trunk/supertux/src/badguy/totem.cpp
===================================================================
--- trunk/supertux/src/badguy/totem.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/totem.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -77,7 +77,7 @@
 Totem::activate()
 {
   if (!carried_by) {
-    physic.vx = (dir == LEFT ? -WALKSPEED : WALKSPEED);
+    physic.set_velocity_x(dir == LEFT ? -WALKSPEED : WALKSPEED);
     sprite-&gt;set_action(dir == LEFT ? &quot;walking-left&quot; : &quot;walking-right&quot;);
     return;
   } else {
@@ -120,7 +120,7 @@
 	float dx = (p1.x - p2.x);
 	if (fabsf(dx - 128) &gt; 2) continue;
 
-	physic.vy = JUMP_ON_SPEED_Y;
+	physic.set_velocity_y(JUMP_ON_SPEED_Y);
 	p1.y -= 1;
 	this-&gt;set_pos(p1);
 	break;
@@ -168,7 +168,7 @@
 
   // If we hit something from above or below: stop moving in this direction
   if (hit.top || hit.bottom) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 
   // If we are hit from the direction we are facing: turn around
@@ -259,7 +259,7 @@
   bbox.set_size(sprite-&gt;get_current_hitbox_width(), sprite-&gt;get_current_hitbox_height());
 
 
-  physic.vy = JUMP_OFF_SPEED_Y;
+  physic.set_velocity_y(JUMP_OFF_SPEED_Y);
 }
 
 void
@@ -275,8 +275,8 @@
   pos.y -= sprite-&gt;get_current_hitbox_height();
   set_pos(pos);
 
-  physic.vx = base-&gt;physic.vx;
-  physic.vy = base-&gt;physic.vy;
+  physic.set_velocity_x(base-&gt;physic.get_velocity_x());
+  physic.set_velocity_y(base-&gt;physic.get_velocity_y());
 }
 
 

Modified: trunk/supertux/src/badguy/walking_badguy.cpp
===================================================================
--- trunk/supertux/src/badguy/walking_badguy.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/walking_badguy.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -52,7 +52,7 @@
     return;
   sprite-&gt;set_action(dir == LEFT ? walk_left_action : walk_right_action);
   bbox.set_size(sprite-&gt;get_current_hitbox_width(), sprite-&gt;get_current_hitbox_height());
-  physic.vx = (dir == LEFT ? -walk_speed : walk_speed);
+  physic.set_velocity_x(dir == LEFT ? -walk_speed : walk_speed);
 }
 
 void
@@ -76,10 +76,10 @@
   update_on_ground_flag(hit);
 
   if (hit.top) {
-    if (physic.vy &lt; 0) physic.vy = 0;
+    if (physic.get_velocity_y() &lt; 0) physic.set_velocity_y(0);
   }
   if (hit.bottom) {
-    if (physic.vy &gt; 0) physic.vy = 0;
+    if (physic.get_velocity_y() &gt; 0) physic.set_velocity_y(0);
   }
 
   if ((hit.left &amp;&amp; (hit.slope_normal.y == 0) &amp;&amp; (dir == LEFT)) || (hit.right &amp;&amp; (hit.slope_normal.y == 0) &amp;&amp; (dir == RIGHT))) {
@@ -106,14 +106,14 @@
     return;
   dir = dir == LEFT ? RIGHT : LEFT;
   sprite-&gt;set_action(dir == LEFT ? walk_left_action : walk_right_action);
-  physic.vx = -physic.vx;
+  physic.set_velocity_x(-physic.get_velocity_x());
 }
 
 void
 WalkingBadguy::freeze()
 {
   BadGuy::freeze();
-  physic.vx = 0;
+  physic.set_velocity_x(0);
 }
 
 void
@@ -127,13 +127,13 @@
 float 
 WalkingBadguy::get_velocity_y() const
 {
-  return physic.vy;
+  return physic.get_velocity_y();
 }
 
 void 
 WalkingBadguy::set_velocity_y(float vy)
 {
-  physic.vy = vy;
+  physic.set_velocity_y(vy);
 }
 
 

Modified: trunk/supertux/src/badguy/yeti.cpp
===================================================================
--- trunk/supertux/src/badguy/yeti.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/yeti.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -88,20 +88,20 @@
 {
   switch(state) {
     case JUMP_DOWN:
-      physic.vx = (dir==RIGHT?JUMP_DOWN_VX:-JUMP_DOWN_VX);
+      physic.set_velocity_x((dir==RIGHT)?+JUMP_DOWN_VX:-JUMP_DOWN_VX);
       break;
     case RUN:
-      physic.vx = (dir==RIGHT?RUN_VX:-RUN_VX);
+      physic.set_velocity_x((dir==RIGHT)?+RUN_VX:-RUN_VX);
       if (((dir == RIGHT) &amp;&amp; (get_pos().x &gt;= RIGHT_JUMP_X)) || ((dir == LEFT) &amp;&amp; (get_pos().x &lt;= LEFT_JUMP_X))) jump_up();
       break;
     case JUMP_UP:
-      physic.vx = (dir==RIGHT?JUMP_UP_VX:-JUMP_UP_VX);
+      physic.set_velocity_x((dir==RIGHT)?+JUMP_UP_VX:-JUMP_UP_VX);
       if (((dir == RIGHT) &amp;&amp; (get_pos().x &gt;= RIGHT_STAND_X)) || ((dir == LEFT) &amp;&amp; (get_pos().x &lt;= LEFT_STAND_X))) be_angry();
       break;
     case BE_ANGRY:
       if(state_timer.check()) {
         sound_manager-&gt;play(&quot;sounds/yeti_gna.wav&quot;);
-        physic.vy = STOMP_VY;
+        physic.set_velocity_y(STOMP_VY);
         sprite-&gt;set_action((dir==RIGHT)?&quot;stomp-right&quot;:&quot;stomp-left&quot;);
       }
       break;
@@ -119,8 +119,8 @@
 Yeti::jump_down()
 {
   sprite-&gt;set_action((dir==RIGHT)?&quot;jump-right&quot;:&quot;jump-left&quot;);
-  physic.vx = (dir==RIGHT?JUMP_DOWN_VX:-JUMP_DOWN_VX);
-  physic.vy = JUMP_DOWN_VY;
+  physic.set_velocity_x((dir==RIGHT)?(+JUMP_DOWN_VX):(-JUMP_DOWN_VX));
+  physic.set_velocity_y(JUMP_DOWN_VY);
   state = JUMP_DOWN;
 }
 
@@ -128,8 +128,8 @@
 Yeti::run()
 {
   sprite-&gt;set_action((dir==RIGHT)?&quot;run-right&quot;:&quot;run-left&quot;);
-  physic.vx = (dir==RIGHT?RUN_VX:-RUN_VX);
-  physic.vy = 0;
+  physic.set_velocity_x((dir==RIGHT)?(+RUN_VX):(-RUN_VX));
+  physic.set_velocity_y(0);
   state = RUN;
 }
 
@@ -137,8 +137,8 @@
 Yeti::jump_up()
 {
   sprite-&gt;set_action((dir==RIGHT)?&quot;jump-right&quot;:&quot;jump-left&quot;);
-  physic.vx = (dir==RIGHT?JUMP_UP_VX:-JUMP_UP_VX);
-  physic.vy = JUMP_UP_VY;
+  physic.set_velocity_x((dir==RIGHT)?(+JUMP_UP_VX):(-JUMP_UP_VX));
+  physic.set_velocity_y(JUMP_UP_VY);
   state = JUMP_UP;
 }
 
@@ -149,8 +149,8 @@
   dir = (dir==RIGHT)?LEFT:RIGHT;
 
   sprite-&gt;set_action((dir==RIGHT)?&quot;stand-right&quot;:&quot;stand-left&quot;);
-  physic.vx = 0;
-  physic.vy = 0;
+  physic.set_velocity_x(0);
+  physic.set_velocity_y(0);
   if (hit_points &lt; INITIAL_HITPOINTS) summon_snowball();
   stomp_count = 0;
   state = BE_ANGRY;
@@ -191,9 +191,9 @@
 
   if(hit_points &lt;= 0) {
     // We're dead
-    physic.gravity_enabled = true;
-    physic.vx = 0;
-    physic.vy = 0;
+    physic.enable_gravity(true);
+    physic.set_velocity_x(0);
+    physic.set_velocity_y(0);
 
     state = SQUISHED;
     state_timer.start(SQUISH_TIME);
@@ -270,7 +270,7 @@
 {
   if(hit.top || hit.bottom) {
     // hit floor or roof
-    physic.vy = 0;
+    physic.set_velocity_y(0);
     switch (state) {
       case JUMP_DOWN:
 	run();

Modified: trunk/supertux/src/badguy/zeekling.cpp
===================================================================
--- trunk/supertux/src/badguy/zeekling.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/badguy/zeekling.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -52,8 +52,8 @@
 Zeekling::activate()
 {
   speed = systemRandom.rand(130, 171);
-  physic.vx = (dir == LEFT ? -speed : speed);
-  physic.gravity_enabled = false;
+  physic.set_velocity_x(dir == LEFT ? -speed : speed);
+  physic.enable_gravity(false);
   sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
 }
 
@@ -71,19 +71,19 @@
   if (state == FLYING) {
     dir = (dir == LEFT ? RIGHT : LEFT);
     sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
-    physic.vx = (dir == LEFT ? -speed : speed);
+    physic.set_velocity_x(dir == LEFT ? -speed : speed);
   } else
   if (state == DIVING) {
     dir = (dir == LEFT ? RIGHT : LEFT);
     state = FLYING;
     sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
-    physic.vx = (dir == LEFT ? -speed : speed);
-    physic.vy = 0;
+    physic.set_velocity_x(dir == LEFT ? -speed : speed);
+    physic.set_velocity_y(0);
   } else
   if (state == CLIMBING) {
     dir = (dir == LEFT ? RIGHT : LEFT);
     sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
-    physic.vx = (dir == LEFT ? -speed : speed);
+    physic.set_velocity_x(dir == LEFT ? -speed : speed);
   } else {
     assert(false);
   }
@@ -92,16 +92,16 @@
 void
 Zeekling::onBumpVertical() {
   if (state == FLYING) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   } else
   if (state == DIVING) {
     state = CLIMBING;
-    physic.vy = -speed;
+    physic.set_velocity_y(-speed);
     sprite-&gt;set_action(dir == LEFT ? &quot;left&quot; : &quot;right&quot;);
   } else
   if (state == CLIMBING) {
     state = FLYING;
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
 }
 
@@ -172,7 +172,7 @@
   if (state == FLYING) {
     if (should_we_dive()) {
       state = DIVING;
-      physic.vy = 2*fabsf(physic.vx);
+      physic.set_velocity_y(2*fabsf(physic.get_velocity_x()));
       sprite-&gt;set_action(dir == LEFT ? &quot;diving-left&quot; : &quot;diving-right&quot;);
     }
     BadGuy::active_update(elapsed_time);
@@ -184,7 +184,7 @@
     // stop climbing when we're back at initial height
     if (get_pos().y &lt;= start_position.y) {
       state = FLYING;
-      physic.vy = 0;
+      physic.set_velocity_y(0);
     }
     BadGuy::active_update(elapsed_time);
     return;

Modified: trunk/supertux/src/object/bullet.cpp
===================================================================
--- trunk/supertux/src/object/bullet.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/bullet.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -37,7 +37,7 @@
   : life_count(3), type(type)
 {
   float speed = dir == RIGHT ? BULLET_XM : -BULLET_XM;
-  physic.vx = speed + xm;
+  physic.set_velocity_x(speed + xm);
 
   if(type == FIRE_BONUS) {
     sprite.reset(sprite_manager-&gt;create(&quot;images/objects/bullets/firebullet.sprite&quot;));
@@ -84,11 +84,11 @@
 Bullet::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.top || hit.bottom) {
-    physic.vy = -physic.vy;
+    physic.set_velocity_y(-physic.get_velocity_y());
     life_count--;
   } else if(hit.left || hit.right) {
     if(type == ICE_BONUS) {
-      physic.vx = -physic.vx;
+      physic.set_velocity_x(-physic.get_velocity_x());
       life_count--;
     } else
       remove_me();

Modified: trunk/supertux/src/object/camera.cpp
===================================================================
--- trunk/supertux/src/object/camera.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/camera.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -279,7 +279,7 @@
   float speed_x = delta_x / elapsed_time;
 
   // limit our speed
-  float maxv = 130 + (fabsf(player-&gt;physic.vx * 1.3));
+  float maxv = 130 + (fabsf(player-&gt;physic.get_velocity_x() * 1.3));
   if(speed_x &gt; maxv)
     speed_x = maxv;
   else if(speed_x &lt; -maxv)

Modified: trunk/supertux/src/object/falling_coin.cpp
===================================================================
--- trunk/supertux/src/object/falling_coin.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/falling_coin.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -29,8 +29,8 @@
 {
   pos = start_position;
   sprite = sprite_manager-&gt;create(&quot;images/objects/coin/coin.sprite&quot;);
-  physic.vy = -800;
-  physic.vx = vel_x;
+  physic.set_velocity_y(-800);
+  physic.set_velocity_x(vel_x);
 }
 
 FallingCoin::~FallingCoin()

Modified: trunk/supertux/src/object/growup.cpp
===================================================================
--- trunk/supertux/src/object/growup.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/growup.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -30,8 +30,8 @@
 GrowUp::GrowUp(Direction direction)
 	: MovingSprite(Vector(0,0), &quot;images/powerups/egg/egg.sprite&quot;, LAYER_OBJECTS, COLGROUP_MOVING)
 {
-  physic.gravity_enabled = true;
-  physic.vx = (direction == LEFT?-100:100);
+  physic.enable_gravity(true);
+  physic.set_velocity_x((direction == LEFT)?-100:100);
   sound_manager-&gt;preload(&quot;sounds/grow.wav&quot;);
 }
 
@@ -45,9 +45,9 @@
 GrowUp::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.top || hit.bottom)
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   if(hit.left || hit.right)
-    physic.vx = -physic.vx;
+    physic.set_velocity_x(-physic.get_velocity_x());
 }
 
 HitResponse

Modified: trunk/supertux/src/object/oneup.cpp
===================================================================
--- trunk/supertux/src/object/oneup.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/oneup.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -29,8 +29,7 @@
 OneUp::OneUp(const Vector&amp; pos, Direction direction)
 	: MovingSprite(pos, &quot;images/powerups/1up/1up.sprite&quot;, LAYER_FLOATINGOBJECTS, COLGROUP_TOUCHABLE)
 {
-  physic.vx = ((direction == LEFT)?-100:100);
-  physic.vy = -400;
+  physic.set_velocity((direction == LEFT)?-100:100, -400);
 }
 
 void

Modified: trunk/supertux/src/object/player.cpp
===================================================================
--- trunk/supertux/src/object/player.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/player.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -166,7 +166,7 @@
   on_ground_flag = false;
   grabbed_object = NULL;
 
-  physic = Physic();
+  physic.reset();
 }
 
 void
@@ -236,7 +236,7 @@
 
   // extend/shrink tux collision rectangle so that we fall through/walk over 1
   // tile holes
-  if(fabsf(physic.vx) &gt; MAX_WALK_XM) {
+  if(fabsf(physic.get_velocity_x()) &gt; MAX_WALK_XM) {
     set_width(34);
   } else {
     set_width(31.8);
@@ -245,8 +245,8 @@
   // on downward slopes, adjust vertical velocity so tux walks smoothly down
   if (on_ground()) {
     if(floor_normal.y != 0) {
-      if ((floor_normal.x * physic.vx) &gt;= 0) {
-        physic.vy = 250;
+      if ((floor_normal.x * physic.get_velocity_x()) &gt;= 0) {
+        physic.set_velocity_y(250);
       }
     }
   }
@@ -255,7 +255,7 @@
   if (backflipping) {
     //prevent player from changing direction when backflipping
     dir = (backflip_direction == 1) ? LEFT : RIGHT;
-    if (backflip_timer.started()) physic.vx = 100 * backflip_direction;
+    if (backflip_timer.started()) physic.set_velocity_x(100 * backflip_direction);
   }
 
   // set fall mode...
@@ -341,26 +341,26 @@
 void
 Player::apply_friction()
 {
-  if ((on_ground()) &amp;&amp; (fabs(physic.vx) &lt; WALK_SPEED)) {
-    physic.vx = 0;
-    physic.ax = 0;
-  } else if(physic.vx &lt; 0) {
-    physic.ax = WALK_ACCELERATION_X * 1.5;
+  if ((on_ground()) &amp;&amp; (fabs(physic.get_velocity_x()) &lt; WALK_SPEED)) {
+    physic.set_velocity_x(0);
+    physic.set_acceleration_x(0);
+  } else if(physic.get_velocity_x() &lt; 0) {
+    physic.set_acceleration_x(WALK_ACCELERATION_X * 1.5);
   } else {
-    physic.ax = WALK_ACCELERATION_X * -1.5;
+    physic.set_acceleration_x(WALK_ACCELERATION_X * -1.5);
   }
 }
 
 void
 Player::handle_horizontal_input()
 {
-  float vx = physic.vx;
-  float vy = physic.vy;
-  float ax = physic.ax;
-  float ay = physic.ay;
+  float vx = physic.get_velocity_x();
+  float vy = physic.get_velocity_y();
+  float ax = physic.get_acceleration_x();
+  float ay = physic.get_acceleration_y();
 
   float dirsign = 0;
-  if(!duck || physic.vy != 0) {
+  if(!duck || physic.get_velocity_y() != 0) {
     if(controller-&gt;hold(Controller::LEFT) &amp;&amp; !controller-&gt;hold(Controller::RIGHT)) {
       old_dir = dir;
       dir = LEFT;
@@ -421,10 +421,8 @@
     }
   }
 
-  physic.vx = vx;
-  physic.vy = vy;
-  physic.ax = ax;
-  physic.ay = ay;
+  physic.set_velocity(vx, vy);
+  physic.set_acceleration(ax, ay);
 
   // we get slower when not pressing any keys
   if(dirsign == 0) {
@@ -448,7 +446,7 @@
   if (!is_big())
     return;
 
-  if (physic.vy != 0)
+  if (physic.get_velocity_y() != 0)
     return;
   if (!on_ground())
     return;
@@ -507,7 +505,7 @@
   if (!on_ground())
     return;
 
-  physic.vy = yspeed;
+  physic.set_velocity_y(yspeed);
   //bbox.move(Vector(0, -1));
   jumping = true;
   on_ground_flag = false;
@@ -528,17 +526,17 @@
   if(controller-&gt;pressed(Controller::JUMP) &amp;&amp; (can_jump)) {
     if (duck) {
       // when running, only jump a little bit; else do a backflip
-      if ((physic.vx != 0) || (controller-&gt;hold(Controller::LEFT)) || (controller-&gt;hold(Controller::RIGHT))) do_jump(-300); else do_backflip();
+      if ((physic.get_velocity_x() != 0) || (controller-&gt;hold(Controller::LEFT)) || (controller-&gt;hold(Controller::RIGHT))) do_jump(-300); else do_backflip();
     } else {
       // jump a bit higher if we are running; else do a normal jump
-      if (fabs(physic.vx) &gt; MAX_WALK_XM) do_jump(-580); else do_jump(-520);
+      if (fabs(physic.get_velocity_x()) &gt; MAX_WALK_XM) do_jump(-580); else do_jump(-520);
     }
   }
   // Let go of jump key
   else if(!controller-&gt;hold(Controller::JUMP)) {
-    if (!backflipping &amp;&amp; jumping &amp;&amp; physic.vy &lt; 0) {
+    if (!backflipping &amp;&amp; jumping &amp;&amp; physic.get_velocity_y() &lt; 0) {
       jumping = false;
-      physic.vy = 0;
+      physic.set_velocity_y(0);
     }
   }
 
@@ -553,11 +551,11 @@
     butt_jump = false;
 
   // swimming
-  physic.ay = 0;
+  physic.set_acceleration_y(0);
   if (swimming) {
     if (controller-&gt;hold(Controller::UP) || controller-&gt;hold(Controller::JUMP))
-      physic.ay = -2000;
-    physic.vy = physic.vy * 0.94;
+      physic.set_acceleration_y(-2000);
+    physic.set_velocity_y(physic.get_velocity_y() * 0.94);
   }
 }
 
@@ -598,7 +596,7 @@
     if(Sector::current()-&gt;add_bullet(
          get_pos() + ((dir == LEFT)? Vector(0, bbox.get_height()/2)
                       : Vector(32, bbox.get_height()/2)),
-         physic.vx, dir))
+         physic.get_velocity_x(), dir))
       shooting_timer.start(SHOOTING_TIME);
   }
 
@@ -686,10 +684,8 @@
   if (controller-&gt;hold(Controller::ACTION)) {
     set_ghost_mode(false);
   }
-  physic.vx = vx;
-  physic.vy = vy;
-  physic.ax = 0;
-  physic.ay = 0;
+  physic.set_velocity(vx, vy);
+  physic.set_acceleration(0, 0);
 }
 
 void
@@ -880,7 +876,7 @@
     }
   else
     {
-    if (fabsf(physic.vx) &lt; 1.0f) // standing
+    if (fabsf(physic.get_velocity_x()) &lt; 1.0f) // standing
       {
       if(dir == LEFT)
         tux_body-&gt;set_action(&quot;stand-left&quot;);
@@ -909,7 +905,7 @@
     }
 
   // Tux is holding something
-  if ((grabbed_object != 0 &amp;&amp; physic.vy == 0) ||
+  if ((grabbed_object != 0 &amp;&amp; physic.get_velocity_y() == 0) ||
       (shooting_timer.get_timeleft() &gt; 0 &amp;&amp; !shooting_timer.check()))
     {
     if (duck)
@@ -973,18 +969,18 @@
 Player::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.bottom) {
-    if(physic.vy &gt; 0)
-      physic.vy = 0;
+    if(physic.get_velocity_y() &gt; 0)
+      physic.set_velocity_y(0);
 
     on_ground_flag = true;
     floor_normal = hit.slope_normal;
   } else if(hit.top) {
-    if(physic.vy &lt; 0)
-      physic.vy =  .2;
+    if(physic.get_velocity_y() &lt; 0)
+      physic.set_velocity_y(.2);
   }
 
   if(hit.left || hit.right) {
-    physic.vx = 0;
+    physic.set_velocity_x(0);
   }
 
   // crushed?
@@ -1053,7 +1049,7 @@
 
   sound_manager-&gt;play(&quot;sounds/hurt.wav&quot;);
 
-  physic.vx = 0;
+  physic.set_velocity_x(0);
 
   if(!completely &amp;&amp; is_big()) {
     if(player_status-&gt;bonus == FIRE_BONUS
@@ -1075,11 +1071,9 @@
             Vector(systemRandom.rand(5), systemRandom.rand(-32,18)),
             systemRandom.rand(-100,100)));
     }
-    physic.gravity_enabled = true;
-    physic.vx = 0;
-    physic.vy = -700;
-    physic.ax = 0;
-    physic.ay = 0;
+    physic.enable_gravity(true);
+    physic.set_acceleration(0, 0);
+    physic.set_velocity(0, -700);
     player_status-&gt;coins -= 25;
     set_bonus(NO_BONUS, true);
     dying = true;
@@ -1106,7 +1100,7 @@
   duck = false;
   last_ground_y = vector.y;
 
-  physic = Physic();
+  physic.reset();
 }
 
 void
@@ -1140,30 +1134,29 @@
 void
 Player::add_velocity(const Vector&amp; velocity)
 {
-  physic.vx += velocity.x;
-  physic.vy += velocity.y;
+  physic.set_velocity(physic.get_velocity() + velocity);
 }
 
 void
 Player::add_velocity(const Vector&amp; velocity, const Vector&amp; end_speed)
 {
   if (end_speed.x &gt; 0)
-    physic.vx = std::min(physic.vx + velocity.x, end_speed.x);
+    physic.set_velocity_x(std::min(physic.get_velocity_x() + velocity.x, end_speed.x));
   if (end_speed.x &lt; 0)
-    physic.vx = std::max(physic.vx + velocity.x, end_speed.x);
+    physic.set_velocity_x(std::max(physic.get_velocity_x() + velocity.x, end_speed.x));
   if (end_speed.y &gt; 0)
-    physic.vy = std::min(physic.vy + velocity.y, end_speed.y);
+    physic.set_velocity_y(std::min(physic.get_velocity_y() + velocity.y, end_speed.y));
   if (end_speed.y &lt; 0)
-    physic.vy = std::max(physic.vy + velocity.y, end_speed.y);
+    physic.set_velocity_y(std::max(physic.get_velocity_y() + velocity.y, end_speed.y));
 }
 
 void
 Player::bounce(BadGuy&amp; )
 {
   if(controller-&gt;hold(Controller::JUMP))
-    physic.vy = -520;
+    physic.set_velocity_y(-520);
   else
-    physic.vy = -300;
+    physic.set_velocity_y(-300);
 }
 
 //Scripting Functions Below
@@ -1174,10 +1167,10 @@
   if (deactivated)
     return;
   deactivated = true;
-  physic.vx = 0;
-  physic.vy = 0;
-  physic.ax = 0;
-  physic.ay = 0;
+  physic.set_velocity_x(0);
+  physic.set_velocity_y(0);
+  physic.set_acceleration_x(0);
+  physic.set_acceleration_y(0);
 }
 
 void
@@ -1190,7 +1183,7 @@
 
 void Player::walk(float speed)
 {
-  physic.vx = speed;
+  physic.set_velocity_x(speed);
 }
 
 void
@@ -1202,12 +1195,12 @@
   if (enable) {
     ghost_mode = true;
     set_group(COLGROUP_DISABLED);
-    physic.gravity_enabled = false;
+    physic.enable_gravity(false);
     log_debug &lt;&lt; &quot;You feel lightheaded. Use movement controls to float around, press ACTION to scare badguys.&quot; &lt;&lt; std::endl;
   } else {
     ghost_mode = false;
     set_group(COLGROUP_MOVING);
-    physic.gravity_enabled = true;
+    physic.enable_gravity(true);
     log_debug &lt;&lt; &quot;You feel solid again.&quot; &lt;&lt; std::endl;
   }
 }

Modified: trunk/supertux/src/object/powerup.cpp
===================================================================
--- trunk/supertux/src/object/powerup.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/powerup.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -36,7 +36,7 @@
   lisp.get(&quot;script&quot;, script);
   no_physics = false;
   lisp.get(&quot;disable-physics&quot;, no_physics);
-  physic.gravity_enabled = true;
+  physic.enable_gravity(true);
   sound_manager-&gt;preload(&quot;sounds/grow.wav&quot;);
   sound_manager-&gt;preload(&quot;sounds/fire-flower.wav&quot;);
 }
@@ -45,10 +45,10 @@
 PowerUp::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.bottom) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   }
   if(hit.right || hit.left) {
-    physic.vx = -physic.vx;
+    physic.set_velocity_x(-physic.get_velocity_x());
   }
 }
 

Modified: trunk/supertux/src/object/pushbutton.cpp
===================================================================
--- trunk/supertux/src/object/pushbutton.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/pushbutton.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -53,10 +53,10 @@
 {
   Player* player = dynamic_cast&lt;Player*&gt;(&amp;other);
   if (!player) return FORCE_MOVE;
-  float vy = player-&gt;physic.vy;
+  float vy = player-&gt;physic.get_velocity_y();
 
   //player-&gt;add_velocity(Vector(0, -150));
-  player-&gt;physic.vy = -150;
+  player-&gt;physic.set_velocity_y(-150);
 
   if (state != OFF) return FORCE_MOVE;
   if (!hit.top) return FORCE_MOVE;

Modified: trunk/supertux/src/object/rock.cpp
===================================================================
--- trunk/supertux/src/object/rock.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/rock.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -64,7 +64,7 @@
   if( grabbed )
     return;
 
-  if (on_ground) physic.vx = 0;
+  if (on_ground) physic.set_velocity_x(0);
 
   movement = physic.get_movement(elapsed_time);
 }
@@ -73,12 +73,11 @@
 Rock::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.top || hit.bottom)
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   if(hit.left || hit.right)
-    physic.vx = 0;
+    physic.set_velocity_x(0);
   if(hit.crush)
-    physic.vx = 0;
-    physic.vy = 0;
+    physic.set_velocity(0, 0);
 
   if(hit.bottom  &amp;&amp; !on_ground) {
     sound_manager-&gt;play(ROCK_SOUND, get_pos());
@@ -90,7 +89,7 @@
 Rock::collision(GameObject&amp; other, const CollisionHit&amp; hit)
 {
   if(!on_ground) {
-    if(hit.bottom &amp;&amp; physic.vy &gt; 200) {
+    if(hit.bottom &amp;&amp; physic.get_velocity_y() &gt; 200) {
       MovingObject* moving_object = dynamic_cast&lt;MovingObject*&gt; (&amp;other);
       if(moving_object) {
         //Getting a rock on the head hurts. A lot.
@@ -119,11 +118,9 @@
   set_group(COLGROUP_MOVING_STATIC);
   on_ground = false;
   if (last_movement.norm() &gt; 1) {
-    physic.vx = ((dir == RIGHT) ? 200 : -200);
-    physic.vy = -200;
+    physic.set_velocity((dir == RIGHT) ? 200 : -200, -200);
   } else {
-    physic.vx = 0;
-    physic.vy = 0;
+    physic.set_velocity(0, 0);
   }
   grabbed = false;
 }

Modified: trunk/supertux/src/object/scripted_object.cpp
===================================================================
--- trunk/supertux/src/object/scripted_object.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/scripted_object.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -79,7 +79,7 @@
 {
   printf(&quot;SetPos: %f %f\n&quot;, x, y);
   bbox.set_pos(Vector(x, y));
-  physic = Physic();
+  physic.reset();
 }
 
 float
@@ -104,13 +104,13 @@
 float
 ScriptedObject::get_velocity_x()
 {
-  return physic.vx;
+  return physic.get_velocity_x();
 }
 
 float
 ScriptedObject::get_velocity_y()
 {
-  return physic.vy;
+  return physic.get_velocity_y();
 }
 
 void
@@ -168,8 +168,7 @@
     return;
 
   if(new_vel_set) {
-    physic.vx = new_vel.x;
-    physic.vy = new_vel.y;
+    physic.set_velocity(new_vel.x, new_vel.y);
     new_vel_set = false;
   }
   movement = physic.get_movement(elapsed_time);
@@ -191,14 +190,14 @@
     return;
 
   if(hit.bottom) {
-    if(physic.vy &gt; 0)
-      physic.vy = 0;
+    if(physic.get_velocity_y() &gt; 0)
+      physic.set_velocity_y(0);
   } else if(hit.top) {
-    physic.vy = .1;
+    physic.set_velocity_y(.1);
   }
 
   if(hit.left || hit.right) {
-    physic.vx = 0;
+    physic.set_velocity_x(0);
   }
 }
 

Modified: trunk/supertux/src/object/skull_tile.cpp
===================================================================
--- trunk/supertux/src/object/skull_tile.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/skull_tile.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -70,7 +70,7 @@
   } else if(hit) {
     if(timer.check()) {
       falling = true;
-      physic.gravity_enabled = true;
+      physic.enable_gravity(true);
       timer.stop();
     } else if(!timer.started()) {
       timer.start(FALLTIME);

Modified: trunk/supertux/src/object/star.cpp
===================================================================
--- trunk/supertux/src/object/star.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/star.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -33,8 +33,7 @@
 Star::Star(const Vector&amp; pos, Direction direction)
 	: MovingSprite(pos, &quot;images/powerups/star/star.sprite&quot;, LAYER_OBJECTS, COLGROUP_MOVING)
 {
-  physic.vx = ((direction == LEFT) ? -SPEED : SPEED);
-  physic.vy = INITIALJUMP;
+  physic.set_velocity((direction == LEFT) ? -SPEED : SPEED, INITIALJUMP);
 }
 
 void
@@ -47,11 +46,11 @@
 Star::collision_solid(const CollisionHit&amp; hit)
 {
   if(hit.bottom) {
-    physic.vy = JUMPSPEED;
+    physic.set_velocity_y(JUMPSPEED);
   } else if(hit.top) {
-    physic.vy = 0;
+    physic.set_velocity_y(0);
   } else if(hit.left || hit.right) {
-    physic.vx = -physic.vx;
+    physic.set_velocity_x(-physic.get_velocity_x());
   }
 }
 

Modified: trunk/supertux/src/object/trampoline.cpp
===================================================================
--- trunk/supertux/src/object/trampoline.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/trampoline.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -70,7 +70,7 @@
     Player* player = dynamic_cast&lt;Player*&gt; (&amp;other);
     //Trampoline works for player
     if(player) {
-      float vy = player-&gt;physic.vy;
+      float vy = player-&gt;physic.get_velocity_y();
       //player is falling down on trampoline
       if(hit.top &amp;&amp; vy &gt;= 0) {
 	if(player-&gt;get_controller()-&gt;hold(Controller::JUMP)) {
@@ -78,7 +78,7 @@
 	} else {
 	  vy = VY_INITIAL;
 	}
-	player-&gt;physic.vy = vy;
+	player-&gt;physic.set_velocity_y(vy);
 	sound_manager-&gt;play(TRAMPOLINE_SOUND);
 	sprite-&gt;set_action(&quot;swinging&quot;, 1);
 	return FORCE_MOVE;

Modified: trunk/supertux/src/object/unstable_tile.cpp
===================================================================
--- trunk/supertux/src/object/unstable_tile.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/object/unstable_tile.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -63,7 +63,7 @@
         state = STATE_DISINTEGRATING;
         sprite-&gt;set_action(&quot;disintegrating&quot;, 1);
         set_group(COLGROUP_DISABLED);
-        physic.gravity_enabled = true;
+        physic.enable_gravity(true);
       }
       break;
 

Modified: trunk/supertux/src/physic.cpp
===================================================================
--- trunk/supertux/src/physic.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/physic.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -23,14 +23,140 @@
 #include &quot;physic.hpp&quot;
 
 Physic::Physic()
-    : ax(0), ay(0), vx(0), vy(0), gravity_enabled(true), gravity(1000)
+    : ax(0), ay(0), vx(0), vy(0), gravity_enabled_flag(true), gravity(1000)
 {
 }
 
+Physic::~Physic()
+{
+}
+
+void
+Physic::reset()
+{
+    ax = ay = vx = vy = 0;
+    gravity_enabled_flag = true;
+}
+
+void
+Physic::set_velocity_x(float nvx)
+{
+  vx = nvx;
+}
+
+void
+Physic::set_velocity_y(float nvy)
+{
+  vy = nvy;
+}
+
+void
+Physic::set_velocity(float nvx, float nvy)
+{
+  vx = nvx;
+  vy = nvy;
+}
+
+void
+Physic::set_velocity(const Vector&amp; vector)
+{
+  vx = vector.x;
+  vy = vector.y;
+}
+
+void Physic::inverse_velocity_x()
+{
+  vx = -vx;
+}
+
+void Physic::inverse_velocity_y()
+{
+  vy = -vy;
+}
+
+float
+Physic::get_velocity_x() const
+{
+    return vx;
+}
+
+float
+Physic::get_velocity_y() const
+{
+    return vy;
+}
+
 Vector
+Physic::get_velocity() const
+{
+  return Vector(vx, vy);
+}
+
+void
+Physic::set_acceleration_x(float nax)
+{
+  ax = nax;
+}
+
+void
+Physic::set_acceleration_y(float nay)
+{
+  ay = nay;
+}
+
+void
+Physic::set_acceleration(float nax, float nay)
+{
+  ax = nax;
+  ay = nay;
+}
+
+float
+Physic::get_acceleration_x() const
+{
+  return ax;
+}
+
+float
+Physic::get_acceleration_y() const
+{
+  return ay;
+}
+
+Vector
+Physic::get_acceleration() const
+{
+  return Vector(ax, ay);
+}
+
+void
+Physic::enable_gravity(bool enable_gravity)
+{
+  gravity_enabled_flag = enable_gravity;
+}
+
+bool
+Physic::gravity_enabled() const
+{
+  return gravity_enabled_flag;
+}
+
+void
+Physic::set_gravity(float gravity)
+{
+  this-&gt;gravity = gravity;
+}
+
+float
+Physic::get_gravity() const
+{
+  return gravity;
+}
+
+Vector
 Physic::get_movement(float elapsed_time)
 {
-  float grav = gravity_enabled ? gravity : 0;
+  float grav = gravity_enabled_flag ? gravity : 0;
 
   Vector result(
       vx * elapsed_time + ax * elapsed_time * elapsed_time,

Modified: trunk/supertux/src/physic.hpp
===================================================================
--- trunk/supertux/src/physic.hpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/physic.hpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -31,15 +31,58 @@
 {
 public:
   Physic();
+  ~Physic();
 
+  /// Resets all velocities and accelerations to 0.
+  void reset();
+
+  /// Sets velocity to a fixed value.
+  void set_velocity(float vx, float vy);
+  void set_velocity(const Vector&amp; vector);
+
+  void set_velocity_x(float vx);
+  void set_velocity_y(float vy);
+
+  /// Velocities invertion.
+  void inverse_velocity_x();
+  void inverse_velocity_y();
+
+  Vector get_velocity() const;
+  float get_velocity_x() const;
+  float get_velocity_y() const;
+
+  /// Set acceleration.
+  /** Sets acceleration applied to the object. (Note that gravity is
+   * eventually added to the vertical acceleration)
+   */
+  void set_acceleration(float ax, float ay);
+
+  void set_acceleration_x(float ax);
+  void set_acceleration_y(float ay);
+
+  Vector get_acceleration() const;
+  float get_acceleration_x() const;
+  float get_acceleration_y() const;
+
+  /// Enables or disables handling of gravity.
+  void enable_gravity(bool gravity_enabled);
+  bool gravity_enabled() const;
+
+  /// Set gravity to apply to object when enabled
+  void set_gravity(float gravity);
+
+  /// Get gravity to apply to object when enabled
+  float get_gravity() const;
+
   Vector get_movement(float elapsed_time);
 
+private:
   /// horizontal and vertical acceleration
   float ax, ay;
   /// horizontal and vertical velocity
   float vx, vy;
-  /// should we respect gravity in our calculations?
-  bool gravity_enabled;
+  /// should we respect gravity in out calculations?
+  bool gravity_enabled_flag;
   /// current gravity to apply to object, if enabled
   float gravity;
 };

Modified: trunk/supertux/src/scripting/functions.cpp
===================================================================
--- trunk/supertux/src/scripting/functions.cpp	2007-01-02 16:14:53 UTC (rev 4523)
+++ trunk/supertux/src/scripting/functions.cpp	2007-01-02 17:07:50 UTC (rev 4524)
@@ -203,7 +203,7 @@
 {
   if (!validate_sector_player()) return;
   ::Player* tux = Sector::current()-&gt;player; // Scripting::Player != ::Player
-  tux-&gt;physic.vx = tux-&gt;physic.vx*3;
+  tux-&gt;physic.set_velocity_x(tux-&gt;physic.get_velocity_x()*3);
 }
 
 void invincible()


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000002.html">[Supertux-commit] r4523 - in trunk/supertux/src: . badguy object	scripting
</A></li>
	<LI>Next message: <A HREF="000004.html">[Supertux-commit] r4525 - in trunk/supertux: data/levels/world2	src/badguy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3">[ date ]</a>
              <a href="thread.html#3">[ thread ]</a>
              <a href="subject.html#3">[ subject ]</a>
              <a href="author.html#3">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/supertux-commit">More information about the Supertux-commit
mailing list</a><br>
</body></html>
